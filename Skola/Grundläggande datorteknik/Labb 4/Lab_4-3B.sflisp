INPORT:			EQU $FC
OUTPORT:		EQU $FB
				ORG $0
state_index:	FCB $0
state_vector:	FCB $0,$0,$0,$0
				ORG $20
start:			LDSP #$20
				LDX state_vector
start_1:		LDA INPORT
				JSR Delay
				LDA state_index
				LDA A,X
				STA OUTPORT
				JSR NextState
				JMP start_1
NextState:		LDA state_index
				INCA
				ANDA #%00000011
				STA state_index
				RTS
Delay:			PSHA
				PSHC
				;LDA #255
Delay_1:		DECA
				BNE Delay_1
				PULC
				PULA
				RTS
				ORG $FF
				FCB $20